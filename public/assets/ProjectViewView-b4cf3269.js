import{m as O,u as Q,c as f,i as a,j as X,o as Y,r as Z,a as l,b as n,d as o,t as r,e as w,w as C,n as g,K as P,k as j,p as U,F as I,g as N,v as $,h as x,f as T}from"./index-fe7ef7ff.js";import{_ as tt,u as ot}from"./_plugin-vue_export-helper-d78e90cf.js";import{V as et,B as st}from"./BreakpointList-3055dbfe.js";const lt={class:"project-view"},nt={key:0,class:"loading-state"},at={key:1,class:"alert alert-danger"},rt={key:2,class:"project-content"},it={key:0,class:"main-content-area"},ut={class:"left-column"},dt={class:"editor-panel video-editor-container"},pt={class:"editor-panel loop-controls"},ct={class:"breakpoint-selectors"},vt={class:"form-group"},mt=["value"],_t={class:"form-group"},bt=["value","disabled"],ft={class:"loop-parameters"},kt={class:"form-group"},yt={class:"form-group"},St={class:"loop-controls-row"},gt={class:"loop-buttons"},jt=["disabled"],Lt=["disabled"],Vt={key:0,class:"loop-status"},wt={class:"right-column"},Ct={class:"editor-panel breakpoint-list-container"},Tt={class:"editor-panel project-notes"},ht={class:"notes-content"},Bt={key:0},Et={key:1,class:"notes-text"},Mt={class:"edit-actions"},Pt={key:1,class:"no-video-message"},Ut={__name:"ProjectViewView",setup(It){const R=O(),D=Q(),p=f(()=>{const e=R.params.id;return e||(console.error("Project ID missing in route params"),D.push("/projects"),null)}),c=ot(),u=a(null),v=f(()=>c.currentProject),F=f(()=>c.loading),h=f(()=>c.error),m=a(""),k=a(""),d=a(null),_=a(null),y=a(3),L=a(1e3),S=a(!1),B=a(0),A=a(0),K=a(0),V=f(()=>c.sortedBreakpoints),E=async()=>{if(p.value)try{await c.fetchProject(p.value),v.value&&(m.value=v.value.videoUrl||"",k.value=v.value.notesText||"")}catch(e){console.error("Failed to load project:",e)}},W=e=>{if(!u.value){console.error("Video editor reference not available");return}u.value.seekTo(e)},M=e=>{if(typeof e!="number"||isNaN(e))return"00:00.00";const t=Math.floor(e/60),b=Math.floor(e%60),s=Math.floor(e%1*100);return`${t.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}.${s.toString().padStart(2,"0")}`},q=e=>{A.value=e},z=e=>{K.value=e},G=e=>{S.value=e.isLooping,e.isLooping&&(B.value=e.currentCount)},H=()=>{d.value===null||_.value===null||!u.value||u.value.startLoop(d.value,_.value,y.value,L.value)},J=()=>{u.value&&u.value.stopLoop()};return X(()=>v.value,e=>{e&&(m.value=e.videoUrl||"",k.value=e.notesText||"")}),Y(()=>{E()}),(e,t)=>{const b=Z("router-link");return l(),n("div",lt,[F.value?(l(),n("div",nt,t[4]||(t[4]=[o("p",null,"Loading project...",-1)]))):h.value?(l(),n("div",at,[o("p",null,r(h.value),1),o("button",{onClick:E,class:"btn btn-primary btn-sm mt-2"}," Retry "),w(b,{to:"/projects",class:"btn btn-secondary btn-sm mt-2 ml-2"},{default:C(()=>t[5]||(t[5]=[T(" Return to Project List ")])),_:1})])):v.value?(l(),n("div",rt,[m.value?(l(),n("div",it,[o("div",ut,[o("div",dt,[(l(),g(P,null,[(l(),g(et,{"video-url":m.value,"project-id":p.value,ref_key:"videoEditorRef",ref:u,"onUpdate:currentTime":q,"onUpdate:duration":z,"onUpdate:loopStatus":G,key:m.value,"read-only":!0},null,8,["video-url","project-id"]))],1024))]),o("div",pt,[t[12]||(t[12]=o("h3",null,"Breakpoint Loop Controls",-1)),o("div",ct,[o("div",vt,[t[7]||(t[7]=o("label",{for:"loopStartSelect"},"Start Breakpoint:",-1)),j(o("select",{id:"loopStartSelect",name:"loopStartSelect","onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),class:"form-control","aria-label":"Select start breakpoint"},[t[6]||(t[6]=o("option",{value:null},"Select starting breakpoint",-1)),(l(!0),n(I,null,N(V.value,(s,i)=>(l(),n("option",{key:`start-${i}`,value:i},r(i+1)+". "+r(M(s.time))+" "+r(s.note?`- ${s.note}`:""),9,mt))),128))],512),[[U,d.value]])]),o("div",_t,[t[9]||(t[9]=o("label",{for:"loopEndSelect"},"End Breakpoint:",-1)),j(o("select",{id:"loopEndSelect",name:"loopEndSelect","onUpdate:modelValue":t[1]||(t[1]=s=>_.value=s),class:"form-control","aria-label":"Select end breakpoint"},[t[8]||(t[8]=o("option",{value:null},"Select ending breakpoint",-1)),(l(!0),n(I,null,N(V.value,(s,i)=>(l(),n("option",{key:`end-${i}`,value:i,disabled:d.value!==null&&i<=d.value},r(i+1)+". "+r(M(s.time))+" "+r(s.note?`- ${s.note}`:""),9,bt))),128))],512),[[U,_.value]])])]),o("div",ft,[o("div",kt,[t[10]||(t[10]=o("label",{for:"loopCountInput"},"Loop Count:",-1)),j(o("input",{type:"number",id:"loopCountInput",name:"loopCountInput","onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),min:"1",max:"20",class:"form-control","aria-label":"Number of loops"},null,512),[[$,y.value,void 0,{number:!0}]])]),o("div",yt,[t[11]||(t[11]=o("label",{for:"waitMsInput"},"Wait Time (milliseconds):",-1)),j(o("input",{type:"number",id:"waitMsInput",name:"waitMsInput","onUpdate:modelValue":t[3]||(t[3]=s=>L.value=s),min:"0",max:"10000",class:"form-control","aria-label":"Wait time between loops"},null,512),[[$,L.value,void 0,{number:!0}]])])]),o("div",St,[o("div",gt,[o("button",{onClick:H,class:"btn btn-success",disabled:d.value===null||_.value===null||S.value,type:"button"}," Start Breakpoint Loop ",8,jt),o("button",{onClick:J,class:"btn btn-danger",disabled:!S.value,type:"button"}," Stop Loop ",8,Lt)]),S.value?(l(),n("div",Vt,[o("p",null,"Looping: "+r(B.value)+" / "+r(y.value),1)])):x("",!0)])])]),o("div",wt,[o("div",Ct,[(l(),g(P,null,[(l(),g(st,{breakpoints:V.value,"read-only":!0,onSeek:W,key:"breakpoint-list"},null,8,["breakpoints"]))],1024))]),o("div",Tt,[t[14]||(t[14]=o("h3",null,"Project Notes",-1)),o("div",ht,[k.value?(l(),n("p",Et,r(k.value),1)):(l(),n("p",Bt,"No notes available"))]),o("div",Mt,[w(b,{to:`/projects/${p.value}/edit`,class:"btn btn-primary"},{default:C(()=>t[13]||(t[13]=[T(" Edit Project ")])),_:1},8,["to"])])])])])):(l(),n("div",Pt,[t[16]||(t[16]=o("p",null,"This project has no video associated with it.",-1)),w(b,{to:`/projects/${p.value}/edit`,class:"btn btn-primary"},{default:C(()=>t[15]||(t[15]=[T(" Edit Project to Add Video ")])),_:1},8,["to"])]))])):x("",!0)])}}},Rt=tt(Ut,[["__scopeId","data-v-831d0919"]]);export{Rt as default};

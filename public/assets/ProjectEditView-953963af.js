import{m as Q,u as X,c as _,i as a,j as Y,o as Z,r as ee,a as n,b as i,d as e,t as r,e as te,w as oe,n as L,K as N,k,p as P,F as M,g as x,v as B,h as I,f as le}from"./index-fe7ef7ff.js";import{_ as ne,u as ae}from"./_plugin-vue_export-helper-d78e90cf.js";import{V as se,B as re}from"./BreakpointList-3055dbfe.js";const ie={class:"project-edit-view"},ue={key:0,class:"loading-state"},de={key:1,class:"alert alert-danger"},ce={key:2,class:"project-content"},pe={class:"main-content-area"},ve={class:"left-column"},me={class:"editor-panel video-editor-container"},be={class:"editor-panel loop-controls"},fe={class:"breakpoint-selectors"},_e={class:"form-group"},ke=["value"],Se={class:"form-group"},ge=["value","disabled"],ye={class:"loop-parameters"},je={class:"form-group"},Ce={class:"form-group"},Le={class:"loop-controls-row"},he={class:"loop-buttons"},we=["disabled"],Be=["disabled"],Ve={key:0,class:"loop-status"},Te={class:"right-column"},Ee={class:"editor-panel breakpoint-list-container"},Ue={class:"editor-panel project-notes"},Ne={class:"save-actions"},Pe=["disabled"],Me={__name:"ProjectEditView",setup(xe){const R=Q(),$=X(),S=_(()=>{const o=R.params.id;return o||(console.error("Project ID missing in route params"),$.push("/projects"),null)}),u=ae(),c=a(null),s=_(()=>u.currentProject),F=_(()=>u.loading),V=_(()=>u.error),g=a(!1),b=a(""),m=a(""),p=a(null),f=a(null),y=a(3),h=a(1e3),j=a(!1),T=a(0),E=a(0),D=a(0),C=_(()=>u.sortedBreakpoints),U=async()=>{if(S.value)try{await u.fetchProject(S.value),s.value&&(b.value=s.value.videoUrl||"",m.value=s.value.notesText||"")}catch(o){console.error("Failed to load project:",o)}},K=async()=>{if(s.value){g.value=!0;try{await u.updateProject(S.value,{name:s.value.name,description:s.value.description,videoUrl:b.value,notesText:m.value}),console.log("Project saved successfully with notes:",m.value)}catch(o){console.error("Failed to save project:",o)}finally{g.value=!1}}},W=async({index:o,note:t})=>{if(s.value)try{const v={...C.value[o],note:t};await u.updateBreakpoint(o,v)}catch(v){console.error("Failed to update breakpoint note:",v)}},A=async o=>{if(s.value)try{await u.removeBreakpoint(o)}catch(t){console.error("Failed to delete breakpoint:",t)}},q=o=>{if(!c.value){console.error("Video editor reference not available");return}console.log("Seeking to time from parent component:",o),c.value.seekTo(o)},w=o=>{if(typeof o!="number"||isNaN(o))return"00:00.00";const t=Math.floor(o/60),v=Math.floor(o%60),l=Math.floor(o%1*100);return`${t.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}.${l.toString().padStart(2,"0")}`},z=o=>{E.value=o,console.log("Current time updated:",w(E.value))},G=o=>{D.value=o},H=o=>{j.value=o.isLooping,o.isLooping&&(T.value=o.currentCount)},J=()=>{p.value===null||f.value===null||!c.value||c.value.startLoop(p.value,f.value,y.value,h.value)},O=()=>{c.value&&c.value.stopLoop()};return Y(()=>s.value,o=>{o&&(b.value=o.videoUrl||"",m.value=o.notesText||"")}),Z(()=>{U()}),(o,t)=>{const v=ee("router-link");return n(),i("div",ie,[F.value?(n(),i("div",ue,t[5]||(t[5]=[e("p",null,"Loading project...",-1)]))):V.value?(n(),i("div",de,[e("p",null,r(V.value),1),e("button",{onClick:U,class:"btn btn-primary btn-sm mt-2"}," Retry "),te(v,{to:"/projects",class:"btn btn-secondary btn-sm mt-2 ml-2"},{default:oe(()=>t[6]||(t[6]=[le(" Return to Project List ")])),_:1})])):s.value?(n(),i("div",ce,[e("div",pe,[e("div",ve,[e("div",me,[(n(),L(N,null,[(n(),L(se,{"video-url":b.value,"project-id":S.value,ref_key:"videoEditorRef",ref:c,"onUpdate:currentTime":z,"onUpdate:duration":G,"onUpdate:loopStatus":H,key:b.value},null,8,["video-url","project-id"]))],1024))]),e("div",be,[t[13]||(t[13]=e("h3",null,"Breakpoint Loop Controls",-1)),e("div",fe,[e("div",_e,[t[8]||(t[8]=e("label",{for:"loopStartSelect"},"Start Breakpoint:",-1)),k(e("select",{id:"loopStartSelect",name:"loopStartSelect","onUpdate:modelValue":t[0]||(t[0]=l=>p.value=l),class:"form-control","aria-label":"Select start breakpoint"},[t[7]||(t[7]=e("option",{value:null},"Select starting breakpoint",-1)),(n(!0),i(M,null,x(C.value,(l,d)=>(n(),i("option",{key:`start-${d}`,value:d},r(d+1)+". "+r(w(l.time))+" "+r(l.note?`- ${l.note}`:""),9,ke))),128))],512),[[P,p.value]])]),e("div",Se,[t[10]||(t[10]=e("label",{for:"loopEndSelect"},"End Breakpoint:",-1)),k(e("select",{id:"loopEndSelect",name:"loopEndSelect","onUpdate:modelValue":t[1]||(t[1]=l=>f.value=l),class:"form-control","aria-label":"Select end breakpoint"},[t[9]||(t[9]=e("option",{value:null},"Select ending breakpoint",-1)),(n(!0),i(M,null,x(C.value,(l,d)=>(n(),i("option",{key:`end-${d}`,value:d,disabled:p.value!==null&&d<=p.value},r(d+1)+". "+r(w(l.time))+" "+r(l.note?`- ${l.note}`:""),9,ge))),128))],512),[[P,f.value]])])]),e("div",ye,[e("div",je,[t[11]||(t[11]=e("label",{for:"loopCountInput"},"Loop Count:",-1)),k(e("input",{type:"number",id:"loopCountInput",name:"loopCountInput","onUpdate:modelValue":t[2]||(t[2]=l=>y.value=l),min:"1",max:"20",class:"form-control","aria-label":"Number of loops"},null,512),[[B,y.value,void 0,{number:!0}]])]),e("div",Ce,[t[12]||(t[12]=e("label",{for:"waitMsInput"},"Wait Time (milliseconds):",-1)),k(e("input",{type:"number",id:"waitMsInput",name:"waitMsInput","onUpdate:modelValue":t[3]||(t[3]=l=>h.value=l),min:"0",max:"10000",class:"form-control","aria-label":"Wait time between loops"},null,512),[[B,h.value,void 0,{number:!0}]])])]),e("div",Le,[e("div",he,[e("button",{onClick:J,class:"btn btn-success",disabled:p.value===null||f.value===null||j.value,type:"button"}," Start Breakpoint Loop ",8,we),e("button",{onClick:O,class:"btn btn-danger",disabled:!j.value,type:"button"}," Stop Loop ",8,Be)]),j.value?(n(),i("div",Ve,[e("p",null,"Looping: "+r(T.value)+" / "+r(y.value),1)])):I("",!0)])])]),e("div",Te,[e("div",Ee,[(n(),L(N,null,[(n(),L(re,{breakpoints:C.value,"onUpdate:note":W,onRemove:A,onSeek:q,key:"breakpoint-list"},null,8,["breakpoints"]))],1024))]),e("div",Ue,[t[14]||(t[14]=e("h3",null,[e("label",{for:"projectNotes"},"Project Notes")],-1)),k(e("textarea",{id:"projectNotes",name:"projectNotes","onUpdate:modelValue":t[4]||(t[4]=l=>m.value=l),class:"form-control notes-textarea",placeholder:"Enter project notes here...","aria-label":"Project notes"},null,512),[[B,m.value]]),e("div",Ne,[e("button",{onClick:K,class:"btn btn-success save-button",disabled:g.value,type:"button"},r(g.value?"Saving...":"Save"),9,Pe)])])])])])):I("",!0)])}}},Fe=ne(Me,[["__scopeId","data-v-526130dc"]]);export{Fe as default};
